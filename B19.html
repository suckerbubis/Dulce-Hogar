<!DOCTYPE html>
<html lang="es" data-bs-theme="dark">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dulce Hogar ‚Äî Gesti√≥n de Newsletter (Bootstrap 5.3.3)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            background-color: var(--bs-body-bg);
            padding-top: 2rem;
            padding-bottom: 2rem;
        }
        .admin-card {
            background-color: var(--bs-secondary-bg-subtle);
            border: 1px solid var(--bs-border-color);
            border-radius: 0.5rem;
            padding: 1.5rem;
            height: 100%;
        }
        .email-preview {
            background: white;
            color: #333;
            border-radius: 0.5rem;
            padding: 1.5rem;
            font-family: Arial, sans-serif;
            max-width: 450px;
            margin: 0 auto;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            min-height: 550px;
        }
        .email-cta {
            display: inline-block;
            background: var(--bs-primary);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.3rem;
            text-decoration: none;
            font-weight: 600;
        }
        .coupon-preview {
            height: 110px;
            background: rgba(var(--bs-warning-rgb), 0.1);
            border: 2px dashed var(--bs-warning);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--bs-warning);
            font-family: monospace;
        }
    </style>
</head>
<body>

<main class="container">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="text-light fw-bolder">üì® Gesti√≥n de Newsletter</h1>
            <p class="text-secondary">Configura campa√±as, programa env√≠os y monitoriza el rendimiento.</p>
        </div>
    </div>

    <div class="row g-4">
        <div class="col-lg-6">
            <div class="admin-card mb-4">
                <h2 class="fs-5 fw-bolder mb-3 pb-2 border-bottom border-secondary">Suscripci√≥n y Rendimiento</h2>
                
                <div class="input-group mb-4">
                    <input type="email" id="subscribe-email" class="form-control bg-dark border-secondary text-light" placeholder="tu@email.com">
                    <button class="btn btn-primary fw-bold" onclick="subscribeNewsletter()">Suscribirme</button>
                </div>
                
                <div class="row text-center g-2 small fw-bold">
                    <div class="col-4">
                        <div class="fs-4 fw-bolder text-warning" id="subscribers-count">1.248</div>
                        <div class="text-muted">Suscriptores</div>
                    </div>
                    <div class="col-4">
                        <div class="fs-4 fw-bolder text-success">68%</div>
                        <div class="text-muted">Tasa de Apertura</div>
                    </div>
                    <div class="col-4">
                        <div class="fs-4 fw-bolder text-info">12%</div>
                        <div class="text-muted">Tasa de Clicks (CTR)</div>
                    </div>
                </div>
            </div>

            <div class="admin-card">
                <h2 class="fs-5 fw-bolder mb-3 pb-2 border-bottom border-secondary">Configuraci√≥n de Campa√±a</h2>
                
                <div class="row g-3">
                    <div class="col-md-6">
                        <label for="campaign-name" class="form-label small text-muted">Nombre de la campa√±a</label>
                        <input type="text" id="campaign-name" class="form-control bg-dark border-secondary text-light" value="Bolet√≠n de novedades">
                    </div>
                    <div class="col-md-6">
                        <label for="frequency" class="form-label small text-muted">Frecuencia</label>
                        <select id="frequency" class="form-select bg-dark border-secondary text-light">
                            <option>Semanal</option><option>Mensual</option>
                        </select>
                    </div>
                    
                    <div class="col-12">
                        <label for="featured-product" class="form-label small text-muted">Producto destacado</label>
                        <select id="featured-product" class="form-select bg-dark border-secondary text-light">
                            <option>Torta de frutillas</option><option>Pan integral</option>
                        </select>
                    </div>
                    
                    <div class="col-12">
                        <label class="form-label small text-muted">Cup√≥n exclusivo</label>
                        <div class="coupon-preview" id="coupon-preview">CUP√ìN: NEWS20</div>
                        <button class="btn btn-sm btn-outline-warning fw-bold" onclick="generateCoupon()"><i class="bi bi-gift-fill me-1"></i> Generar cup√≥n</button>
                    </div>

                    <div class="col-md-6">
                        <label for="schedule-date" class="form-label small text-muted">Fecha de env√≠o</label>
                        <input type="datetime-local" id="schedule-date" class="form-control bg-dark border-secondary text-light">
                    </div>
                </div>
                
                <div class="d-flex gap-3 mt-4 pt-3 border-top border-secondary-subtle">
                    <button class="btn btn-success fw-bold" onclick="scheduleNewsletter()"><i class="bi bi-clock-fill me-1"></i> Programar env√≠o</button>
                    <button class="btn btn-outline-light fw-bold" onclick="testNewsletter()"><i class="bi bi-envelope-fill me-1"></i> Enviar prueba</button>
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="admin-card mb-4">
                <h2 class="fs-5 fw-bolder mb-3 pb-2 border-bottom border-secondary">Vista Previa (Email Responsivo)</h2>
                <div class="email-preview">
                    <div class="text-center">
                        <h3 class="fw-bolder text-primary">Dulce Hogar</h3>
                        <p class="small text-muted border-bottom pb-2">Bolet√≠n de novedades - Mayo 2024</p>
                    </div>
                    <div class="text-dark">
                        <h4 class="fw-bolder fs-6 mb-3">üéâ ¬°Promociones Exclusivas!</h4>
                        <div class="row g-2 mb-3">
                            <div class="col-4 text-center"><i class="bi bi-cake2 fs-3"></i></div>
                            <div class="col-4 text-center"><i class="bi bi-bagel fs-3"></i></div>
                            <div class="col-4 text-center"><i class="bi bi-star-fill text-warning fs-3"></i></div>
                        </div>
                        <p class="mb-3 small">
                            Este mes presentamos nuestra nueva l√≠nea de productos org√°nicos y recetas exclusivas.
                        </p>
                        <p class="fw-bold small mb-2">Cup√≥n: NEWS20</p>
                        <a href="#" class="email-cta fw-bold small">Ver producto destacado</a>
                    </div>
                </div>
            </div>

            <div class="admin-card">
                <h2 class="fs-5 fw-bolder mb-3 pb-2 border-bottom border-secondary">Campa√±as Programadas</h2>
                <div class="d-flex justify-content-between align-items-center mb-2 p-2 rounded bg-dark">
                    <div>
                        <strong class="text-light">üéâ D√≠a de la Madre</strong>
                        <div class="small text-muted">Programado para: 08/05 10:00</div>
                    </div>
                    <span class="badge bg-success">Programado</span>
                </div>
                <div class="d-flex justify-content-between align-items-center mb-2 p-2 rounded bg-dark">
                    <div>
                        <strong class="text-light">üå± Productos Org√°nicos</strong>
                        <div class="small text-muted">Programado para: 15/05 09:00</div>
                    </div>
                    <span class="badge bg-warning text-dark">Borrador</span>
                </div>
                <button class="btn btn-sm btn-outline-primary mt-3" onclick="createNewCampaign()">
                    <i class="bi bi-plus-lg me-1"></i> Nueva campa√±a
                </button>
            </div>
        </div>
    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script>
    const subscribersCountEl = document.getElementById('subscribers-count');

    // Simulaci√≥n de la funci√≥n para mostrar notificaciones (Toast)
    function showToast(message, type = 'info') {
        console.log(`[Toast ${type.toUpperCase()}]: ${message}`);
    }

    // --- L√≥gica de la UI y API (Simulada) ---
    
    // Simulaci√≥n de suscripci√≥n (API Call: POST /api/newsletter/subscribe)
    function subscribeNewsletter() {
        const emailInput = document.getElementById('subscribe-email');
        const email = emailInput.value.trim();
        
        if (!email || !email.includes('@')) {
            alert('Por favor ingresa un email v√°lido');
            return;
        }
        
        // Simulaci√≥n: Llamada a la API
        alert(`¬°Gracias por suscribirte, ${email}!\n\n(API Call: POST /api/newsletter/subscribe)`);
        
        // Actualizar estad√≠sticas (demo)
        let subscribers = parseInt(subscribersCountEl.textContent.replace(',', '')) || 1248;
        subscribers++;
        subscribersCountEl.textContent = subscribers.toLocaleString();
        emailInput.value = '';
    }
    
    // Simulaci√≥n de generar cup√≥n (API Call: POST /api/promotions/coupon/generate)
    function generateCoupon() {
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        let coupon = '';
        for (let i = 0; i < 6; i++) {
            coupon += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        
        const couponPreview = document.getElementById('coupon-preview');
        couponPreview.innerHTML = `CUP√ìN: ${coupon}`;
        showToast(`Nuevo cup√≥n "${coupon}" generado y listo para incluir en la campa√±a.`, 'warning');
        
        // API Call impl√≠cita para generar c√≥digo √∫nico
        console.log(`API Call: POST /api/promotions/coupon/generate -> ${coupon}`);
    }
    
    // Simulaci√≥n de env√≠o de prueba (API Call: POST /api/campaigns/test)
    function testNewsletter() {
        const testEmail = prompt('Enviar prueba a:', 'tester@dulcehogar.cl');
        if (testEmail) {
            alert(`üì® Newsletter de prueba enviado a: ${testEmail}\n\n(API Call: POST /api/campaigns/test)`);
        }
    }
    
    // Simulaci√≥n de programaci√≥n (API Call: POST /api/campaigns/send)
    function scheduleNewsletter() {
        const dateInput = document.getElementById('schedule-date').value;
        if (!dateInput) {
            alert('Por favor, selecciona una fecha y hora.');
            return;
        }
        
        const subscribers = subscribersCountEl.textContent;
        alert(`‚úÖ Newsletter programado para: ${dateInput}\n\nSe enviar√° a ${subscribers} suscriptores.\n(API Call: POST /api/campaigns/send)`);
        
        // Simulaci√≥n de agregar a la lista de programados
        const scheduledList = document.querySelector('.admin-card:nth-child(4) > div:nth-child(2)');
        const newCampaign = document.createElement('div');
        newCampaign.className = 'd-flex justify-content-between align-items-center mb-2 p-2 rounded bg-dark';
        newCampaign.innerHTML = `
            <div>
                <strong class="text-light">Nueva Campa√±a</strong>
                <div class="small text-muted">Programado para: ${dateInput.replace('T', ' ')}</div>
            </div>
            <span class="badge bg-success">Programado</span>
        `;
        scheduledList.prepend(newCampaign);
    }
    
    // Simulaci√≥n de crear nueva campa√±a
    function createNewCampaign() {
        alert('üìù Nueva campa√±a creada. (API Call: POST /api/campaigns)');
    }
    
    // Inicializar
    document.addEventListener('DOMContentLoaded', function() {
        // Establecer fecha por defecto (ma√±ana)
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        const formattedDate = tomorrow.toISOString().slice(0, 16);
        document.getElementById('schedule-date').value = formattedDate;
    });
</script>
</body>
</html>
