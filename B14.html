<!DOCTYPE html>
<html lang="es" data-bs-theme="dark">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dulce Hogar ‚Äî Cupones de Descuento (Bootstrap 5.3.3)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            background-color: var(--bs-body-bg);
            padding-top: 2rem;
            padding-bottom: 2rem;
        }
        .coupon-card {
            background-color: var(--bs-secondary-bg-subtle);
            border: 2px solid var(--bs-border-color);
            border-radius: 0.5rem;
            padding: 1.5rem;
            position: relative;
        }
        .coupon-card.premium {
            border-color: var(--bs-warning);
        }
        .coupon-card.expired {
            opacity: 0.6;
            filter: grayscale(0.5);
        }
        .coupon-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--bs-primary);
        }
        .coupon-code {
            background-color: var(--bs-dark);
            border: 1px dashed var(--bs-secondary-color);
            border-radius: 0.3rem;
            font-family: monospace;
            cursor: pointer;
        }
        .strike-price {
            position: relative;
        }
        .strike-price::after {
            content: "";
            position: absolute;
            left: 0;
            right: 0;
            top: 50%;
            height: 2px;
            background: var(--bs-danger);
            transform: rotate(-6deg);
        }
    </style>
</head>
<body>

<main class="container">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="text-center mb-4">
                <h1 class="text-light fw-bolder">üéüÔ∏è Tus Cupones</h1>
                <p class="text-secondary">Aplica cupones en tu pr√≥xima compra y ahorra.</p>
            </div>

            <div class="tracking-card mb-4 p-4 border-primary">
                <h2 class="fs-5 fw-bolder mb-3">Aplicar un c√≥digo de cup√≥n</h2>
                <div class="input-group mb-3">
                    <input type="text" 
                           id="coupon-input" 
                           class="form-control form-control-lg bg-dark border-secondary text-light"
                           placeholder="Ingresa tu c√≥digo de cup√≥n">
                    <button class="btn btn-primary btn-lg fw-bold" onclick="applyCoupon()">
                        <i class="bi bi-tag-fill me-1"></i> Aplicar
                    </button>
                </div>
                
                <div id="coupon-result" class="alert d-none" role="alert"></div>
            </div>

            <h2 class="fs-5 fw-bolder mb-3">Cupones disponibles</h2>
            <div class="row coupon-grid g-4 mb-5">
                <div class="col-md-6 col-lg-4">
                    <div class="coupon-card premium border-warning">
                        <div class="badge bg-warning text-dark position-absolute top-0 end-0 m-3">PREMIUM</div>
                        <h3 class="fs-6 fw-bold mt-2">¬°Bienvenida Primavera!</h3>
                        <div class="coupon-value text-warning">30% OFF</div>
                        <p class="small text-secondary mb-3">En toda la tienda.</p>
                        
                        <div class="coupon-code p-2 mb-3 text-light" onclick="copyCode('SPRING30')">
                            SPRING30
                        </div>
                        
                        <p class="small text-muted mb-1">üìÖ V√°lido hasta: 30/09/2024</p>
                        <p class="small text-muted mb-3">üéØ Usos restantes: 1</p>
                        
                        <button class="btn btn-sm btn-primary me-2" onclick="applyCode('SPRING30')">Aplicar ahora</button>
                        <button class="btn btn-sm btn-outline-light" onclick="shareCoupon('SPRING30')">Compartir</button>
                    </div>
                </div>

                <div class="col-md-6 col-lg-4">
                    <div class="coupon-card">
                        <h3 class="fs-6 fw-bold">Descuento Panader√≠a</h3>
                        <div class="coupon-value">20% OFF</div>
                        <p class="small text-secondary mb-3">En productos de panader√≠a artesanal.</p>
                        
                        <div class="coupon-code p-2 mb-3 text-light" onclick="copyCode('PAN20')">
                            PAN20
                        </div>
                        
                        <p class="small text-muted mb-1">üìÖ V√°lido hasta: 15/10/2024</p>
                        <p class="small text-muted mb-3">üéØ Usos restantes: 2</p>
                        
                        <button class="btn btn-sm btn-primary me-2" onclick="applyCode('PAN20')">Aplicar ahora</button>
                        <button class="btn btn-sm btn-outline-light" onclick="shareCoupon('PAN20')">Compartir</button>
                    </div>
                </div>
            </div>

            <div class="tracking-card p-4 border-info">
                <h2 class="fs-5 fw-bolder mb-3">üéØ Simulaci√≥n en el Carrito</h2>
                
                <div class="p-3 bg-dark rounded">
                    <div class="d-flex justify-content-between mb-2">
                        <span class="small fw-bold">Subtotal de la compra:</span>
                        <span class="fw-bold strike-price text-danger" id="demo-subtotal">$10.000</span>
                    </div>
                    
                    <div class="d-flex justify-content-between mb-3">
                        <span class="small fw-bold">Descuento aplicado ("PAN20"):</span>
                        <span class="fw-bold text-success" id="demo-discount">- $2.000</span>
                    </div>
                    
                    <div class="d-flex justify-content-between pt-2 border-top border-secondary-subtle">
                        <span class="fw-bolder fs-5">Total final:</span>
                        <span class="fw-bolder fs-4 text-primary" id="demo-total">$8.000</span>
                    </div>
                </div>
                
                <div class="alert alert-success fw-bold mt-3" id="demo-success-message">
                    ‚úÖ Cup√≥n "PAN20" aplicado exitosamente. ¬°Ahorraste $2.000!
                </div>
                
                <div class="alert alert-danger fw-bold mt-3 d-none" id="demo-error-message">
                    ‚ùå Cup√≥n no v√°lido o expirado. (Simulaci√≥n de error)
                </div>
                
                <button class="btn btn-sm btn-outline-danger mt-3" onclick="showErrorDemo()">
                    Simular cup√≥n inv√°lido
                </button>
            </div>
        </div>
    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script>
    // Simulaci√≥n de la funci√≥n para mostrar notificaciones (Toast)
    function showToast(message, type = 'info') {
        console.log(`[Toast ${type.toUpperCase()}]: ${message}`);
    }

    // Simulaci√≥n de aplicaci√≥n de cup√≥n (API Call: POST /api/coupon/validate)
    function applyCoupon() {
        const input = document.getElementById('coupon-input');
        const code = input.value.trim().toUpperCase();
        const resultDiv = document.getElementById('coupon-result');
        
        resultDiv.classList.add('d-none'); // Ocultar antes de procesar
        
        if (!code) {
            resultDiv.textContent = '‚ùå Por favor ingresa un c√≥digo de cup√≥n';
            resultDiv.className = 'alert alert-danger';
            resultDiv.classList.remove('d-none');
            return;
        }
        
        // Simulaci√≥n de cupones v√°lidos
        const validCoupons = ['SPRING30', 'PAN20', 'FREESHIP'];
        
        // Simulaci√≥n de llamada API
        setTimeout(() => {
            if (validCoupons.includes(code)) {
                resultDiv.textContent = `‚úÖ Cup√≥n "${code}" aplicado. ¬°Redireccionando al carrito!`;
                resultDiv.className = 'alert alert-success';
                
                // Redirigir al carrito para ver el impacto
                setTimeout(() => {
                    // En un caso real, aqu√≠ guardar√≠amos el cup√≥n en sesi√≥n y redirigir√≠amos
                    window.location.href = 'cart.html?coupon=' + code; 
                }, 1000);
            } else {
                resultDiv.textContent = `‚ùå Cup√≥n "${code}" no v√°lido o expirado.`;
                resultDiv.className = 'alert alert-danger';
            }
            resultDiv.classList.remove('d-none');
        }, 800);
    }
    
    function copyCode(code) {
        navigator.clipboard.writeText(code).then(() => {
            showToast(`C√≥digo "${code}" copiado al portapapeles`, 'success');
        });
    }
    
    function applyCode(code) {
        document.getElementById('coupon-input').value = code;
        applyCoupon();
    }
    
    function shareCoupon(code) {
        const url = window.location.href;
        const text = `¬°Usa mi c√≥digo de cup√≥n "${code}" en Dulce Hogar y ahorra! üçû`;
        
        if (navigator.share) {
            navigator.share({ title: `Cup√≥n ${code}`, text: text, url: url });
        } else {
            navigator.clipboard.writeText(text).then(() => {
                showToast('¬°Cup√≥n copiado! Puedes compartirlo.', 'info');
            });
        }
    }
    
    function showErrorDemo() {
        const errorDiv = document.getElementById('demo-error-message');
        const successDiv = document.getElementById('demo-success-message');
        
        successDiv.classList.add('d-none');
        errorDiv.classList.remove('d-none');
        
        setTimeout(() => {
            errorDiv.classList.add('d-none');
            successDiv.classList.remove('d-none');
        }, 3000);
    }
</script>
</body>
</html>
